<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap-datetimepicker.css"/>
    <link rel="stylesheet" href="css/bootstrap-editable.css">
    <link rel="stylesheet" href="css/bootstrap-table.min.css">
    <link rel="stylesheet" href="css/public.css"/>
    <link rel="stylesheet" href="css/common.css"/>

    <script src="assets/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="js/vendor/moment.js"></script>
    <script src="js/vendor/bootstrap-datetimepicker.min.js"></script>
    <script src="js/vendor/bootstrap-table.min.js"></script>
    <script src="js/vendor/bootstrap-table-zh-CN.min.js"></script>
    <script src="js/vendor/vue.js"></script>
    <script src="js/vendor/axios.js"></script>

</head>
<body>

<div class="conts" id="divCenter" align="center"
     style="position: fixed; top: 50px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.4); display: none;z-index:909;left:0px;overflow: scroll;">
    <img id="carpic3" src="#" style="padding-top: 5%;width: 60%;height: auto;"/><a href="javascript:void(0);"
                                                                                   onclick="picClose();">
    <img src="img/close-150192_640.png"
         style="width: 50px;height: 50px;float: right;position:fixed;z-index: 999;margin-top: 70px;right: 80px;"></a>
</div>
<!--冻结-->
<div id="wrap1"
     style="position: fixed; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: none;z-index:909;left:0px;">
    <div style="width: 620px;height: 32px;background: #636161;margin: 0 auto;margin-top: 100px;opacity: 1">
        <p style="font-size: 18px; color:#FFF; font-weight:600;line-height: 28px;margin-left: 15px">账户操作</p>
    </div>
    <div style="width: 620px;height: 260px;background: #FFF;margin: 0 auto;opacity: 1">
        <div style="float: left;margin-top: 30px;  padding-left:3%;">
            <p style="padding: 10px; display: inline-block">余额(元): </p>
            <div type="text" class=" unlock  "
                 style="display: inline-block;width: 80px;margin-left: 15px;color:#777;"></div>
            <p style="padding: 10px; display: inline-block">冻结余额（元）: </p>
            <div type="text" class="  balance "
                 style="display: inline-block;width: 80px;margin-left: 15px; color:#777;"></div>
            <p style="padding: 10px; display: inline-block">赠送余额（元）: </p>
            <div type="text" class=" virtual  "
                 style="display: inline-block;width: 80px;margin-left: 15px;color:#777;"></div>
        </div>

        <div style="float: left;margin-top: 40px;  padding-left:32%;">
            <button type="button" class="btn btn-default " id="btn-6"
                    style="width: 100px;display: inline-block;float: left; margin-right:25px;">冻结账户
            </button>
            <button type="button" class="btn btn-default " id="btn-7"
                    style="width: 100px;display: inline-block;float: left;margin-right:5px;">取消冻结
            </button>
        </div>
        <div style="float: right;margin-top: 120px;margin-right: 40px">
            <button type="button" class="btn btn-default " id="555"
                    style="width: 100px;float: right;background: #636161;color:#F3F3F3;display: inline-block">取消
            </button>
        </div>
    </div>
</div>

<form id="formId">
    <div id="eatTheWorld"
         style="position: fixed; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: none;z-index:1009;left:0px;">
        <div style="width: 800px;height: 32px;background: #636161;margin: 0 auto;margin-top: 100px;opacity: 1">
            <p style="font-size: 18px; color:#FFF; font-weight:600;line-height: 28px;margin-left: 15px">用户详情</p>
        </div>
        <div style="width: 800px;height: 300px;background: #FFF;margin: 0 auto;opacity: 1">

            <div style="text-align:left;">
                <p style="padding-top: 45px;padding-left: 33px; display: inline-block"><span style="color:red;">*</span>昵称：
                </p><input type="text" class="form-control ename"
                           style="display: inline-block;width: 300px;margin-left: 2px;">
                <p style="padding-top: 25px;padding-left: 1px; display: inline-block"><span style="color:red;">*</span>手机号码：
                </p><input type="text" class="form-control ephone"
                           style="display: inline-block;width: 300px;margin-left: -2px;">
                <p style="padding-top: 25px;padding-left: 20px; display: inline-block"><span style="color:red;">*</span>用户名：
                </p> <input type="text" class="form-control elogname"
                            style="display: inline-block;width: 300px;margin-left: -1px;">
                <p style="padding-top: 25px;padding-left: 2px; display: inline-block"><span style="color:red;">*</span>登录密码:
                </p><input type="text" class="form-control epassword"
                           style="display: inline-block;width: 300px;margin-left: 7px;">
                <p style="padding-top: 25px;padding-left: 12px; display: inline-block">真实姓名：</p><input type="text"
                                                                                                       class="form-control erealname"
                                                                                                       style="display: inline-block;width: 300px;margin-left: 4px;">
                <p style="padding-top: 25px;padding-left: 3px; display: inline-block">身份证号：</p><input type="text"
                                                                                                      class="form-control eidcard"
                                                                                                      style="display: inline-block;width: 300px;margin-left: 2px;">


            </div>


            <div style="float: right;margin-top: 55px;margin-right: 45px">

                <!--<button type="button" class="btn btn-default  sendAll" style="width: 100px;background: #169BD5;color:#F3F3F3">确定</button>-->


                <button type="button" class="btn btn-default" id="add1"
                        style="width: 100px;background: #636161;color:#F3F3F3">确定
                </button>
                <!--  提示框-->


                <button type="button" class="btn btn-default" id="888" style="width: 100px; margin-left:15px;">取消
                </button>
            </div><!--确定取消-->

        </div>
    </div>
</form>
<!--编辑-->
<div id="eatTheWorld2"
     style="position: fixed; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: none;z-index:1009;left:0px;">
    <div style="width: 800px;height: 32px;background: #636161;margin: 0 auto;margin-top: 100px;opacity: 1">
        <p style="font-size: 18px; color:#FFF; font-weight:600;line-height: 28px;margin-left: 15px">用户详情</p>
    </div>
    <div style="width: 800px;height: 300px;background: #FFF;margin: 0 auto;opacity: 1">
        <p style="padding-top: 20px;padding-left: 23px; display: inline-block">用户ID：<span style="font-weight: 700"
                                                                                          class="userid">1234</span></p>
        <div style="text-align:left;">

            <div>
                <p style="padding-top: 25px;padding-left: 36px; display: inline-block">昵称：</p><input type="text"
                                                                                                     class="form-control name"
                                                                                                     style="display: inline-block;width: 300px;margin-left: 2px;">
                <p style="padding-top: 25px;padding-left: 7px; display: inline-block">手机号码：</p><input type="text"
                                                                                                      class="form-control phone"
                                                                                                      style="display: inline-block;width: 300px;margin-left: -1px;">
            </div>
            <div>
                <p style="padding-top: 25px;padding-left: 23px; display: inline-block">用户名：</p> <input type="text"
                                                                                                       class="form-control logname"
                                                                                                       style="display: inline-block;width: 300px;margin-left: -2px;">
                <p style="padding-top: 25px;padding-left: 9px; display: inline-block">登录密码:</p><input type="text"
                                                                                                      class="form-control password"
                                                                                                      style="display: inline-block;width: 300px;margin-left: 7px;">
            </div>
            <div>
                <p style="padding-top: 25px;padding-left: 11px; display: inline-block">真实姓名：</p><input type="text"
                                                                                                       class="form-control realname"
                                                                                                       style="display: inline-block;width: 300px;margin-left: 1px;">
                <p style="padding-top: 25px;padding-left: 6px; display: inline-block">身份证号：</p><input type="text"
                                                                                                      class="form-control idcard"
                                                                                                      style="display: inline-block;width: 300px;margin-left: 1px;">
            </div>

        </div>


        <div style="float: right;margin-top: 25px;margin-right: 48px">

            <!--<button type="button" class="btn btn-default  sendAll" style="width: 100px;background: #169BD5;color:#F3F3F3">确定</button>-->


            <button type="button" class="btn btn-default" id="revise"
                    style="width: 100px;background: #636161;color:#F3F3F3">确定
            </button>
            <!--  提示框-->


            <button type="button" class="btn btn-default" id="999" style="width: 100px; margin-left:15px;">取消</button>
        </div><!--确定取消-->

    </div>
</div>
<!--网点-->
<div id="wrap"
     style="position: fixed; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: none;z-index:909;left:0px;">
    <div style="width: 800px;height: 32px;background: #636161;margin: 0 auto;margin-top: 100px;opacity: 1">
        <p style="font-size: 18px; color:#FFF; font-weight:600;line-height: 28px;margin-left: 15px">网点列表</p>
    </div>
    <div style="width: 800px;height: 460px;background: #FFF;margin: 0 auto;opacity: 1">
        <div data-toggle="distpicker" class="form-group form-inline" style="padding-top:30px;">
            <select data-province="---- 选择省 ----" class="form-control selpr" style="margin-left: 20px;"></select>
            <select data-city="---- 选择市 ----" class="form-control selci"></select>
            <select data-district="---- 选择区 ----" class="form-control selco"></select>
            <button type="button" class="btn btn-default searchWD" style="margin-top: 0px;">筛选</button>
        </div>
        <div id="app">
            <label style="display: block;margin-top: 0px">
                <ul class="nav nav-pills nav-stacked" style="overflow-y: scroll;-ms-overflow-y:scroll; height:300px;"
                    id="app1">
                    <li v-for="(item,index) in message" style="font-size:15px; font-weight:400;" class="removeD"><a
                            @click="online(index,item.id,$event)" class="hoverE">{{item.name}}({{item.address}})</a>
                    </li>
                </ul>
            </label>
        </div>

        <div style="float: right;margin-top: 10px;margin-right: 45px">
            <button type="button" class="btn btn-default  " id="wrap-btn-on"
                    style="width: 100px;background: #636161;color:#F3F3F3;display: inline-block; margin-right:10px;">确定
            </button>
            <!--  提示框-->
            <button type="button" class="btn btn-default " id="wrap-btn-off"
                    style="width: 100px;display: inline-block;float: right">取消
            </button>
        </div>
    </div>
</div>

<div class="ui-content">
    <div class="form-inline" id="toolbar">
        <input type="text"
               class="form-control ui-toolbar-widget searchResult"
               placeholder="输入手机号或身份证号搜索用户"
               onblur="if(this.placeholder==''){this.placeholder='输入手机号或身份证号搜索用户'}"
               onfocus="if(this.placeholder=='输入手机号或身份证号搜索用户'){this.placeholder=''}"
               style="width: 250px">
        <button type="button" class="btn btn-primary ui-toolbar-widget searchCcusn searchCcu" ><span class="glyphicon glyphicon-search"></span></button>
    </div>
    <table id="table"
           data-search="false"
           data-show-refresh="true"
           data-show-toggle="false"
           data-show-columns="false"
           data-toolbar="#toolbar"
           data-click-to-select="true"
           data-show-export="false"
           data-minimum-count-columns="2"
           data-pagination="true"
           data-id-field="ccuSn"
           data-page-list="[10, 20, 50, 100, ALL]"
           data-show-footer="false"
           data-side-pagination="server"
           data-url="http://cjl3.rokyinfo.net:7200/api-user/v3.1/users"
           data-cache="true"
           data-response-handler="responseHandler">

    </table>

</div>


</body>

<script>
    var $table = $('#table');
    var dataResult;
    var url = "http://cjl3.rokyinfo.net:7200/api-user/v3.1/users";

    function initTable() {
        $table.bootstrapTable("destroy");
        $table.bootstrapTable({
            height: getHeight(),
            url: url,
            method: 'GET',
            dataType: 'json',
            contentType: "application/json; charset=utf-8",
            cache: false,
            striped: true,                              //是否显示行间隔色
            onLoadError: function (data) {
                $table.bootstrapTable("refresh", {silent: true});
            },
            ajaxOptions: {
                headers: {
                    "firm": JSON.parse(sessionStorage.name)[sessionStorage.Vname].flag,
                    "Authorization": sessionStorage.token
                }
            },
            queryParams: queryParams,
            minimumCountColumns: 2,
            pageNumber: 1,                       //初始化加载第一页，默认第一页
            pageSize: 100,                       //每页的记录行数（*）
            pageList: [10, 20, 100],        //可供选择的每页的行数（*）
            columns: [
                {
                    field: '',
                    title: '',
                    align: 'center',
                    valign: 'middle',
                    events: operateEvents,
                    formatter: function (value, row, index) {
                        return '  <input type="checkbox" class="delete">'
                    }
                },
                {
                    field: '',
                    title: '',
                    align: 'center',
                    valign: 'middle',
                    formatter: function (value, row, index) {
                        /*console.log((dataResult.pageSize * (dataResult.currPage - 1)) + index + 1)*/
                        return (dataResult.pageSize * (dataResult.currPage - 1)) + index + 1;
                    }
                },


                {
                    field: 'nickname',
                    title: '昵称',
                    align: 'center',
                    valign: 'middle',
                    events: operateEvents,
                    formatter: nikFormatter

                },
                {
                    field: 'phoneNumber',
                    title: '手机号码',
                    align: 'center',
                    valign: 'middle'
                },

                {
                    field: 'realname',
                    title: '姓名',
                    align: 'center',
                    valign: 'middle',
                    formatter: realFormatter
                },
                {
                    field: 'gender',
                    title: '性别',
                    align: 'center',
                    valign: 'middle',
                    formatter: genderFormatter
                },
                {
                    field: 'yue',
                    title: '余额',
                    align: 'center',
                    valign: 'middle',
                    formatter: yueFormatter
                },

                {
                    field: 'rentOrderStatus',
                    title: '状态',
                    align: 'center',
                    valign: 'middle'
                },
                {
                    field: 'idCardImgs',
                    title: '图片',
                    align: 'center',
                    valign: 'middle',
                    events: operateEvents,
                    formatter: picsFormatter

                },
                {
                    field: 'createTime',
                    title: '创建时间',
                    align: 'center',
                    valign: 'middle',
                    formatter: ctimeFormatter

                },
                {
                    field: 'modifyTime',
                    title: '修改时间',
                    align: 'center',
                    valign: 'middle',
                    formatter: mtimeFormatter
                }

            ]
        });
        // sometimes footer render error.
    }

    function yueFormatter(value, row, index) {
        var inner;
        inner = row.accountEntity.unlockBalance
        return [
            '<span>' + inner + '</span>'
        ].join('');
    }//余额
    function ctimeFormatter(value, row, index) {
        if (row.createTime == null || row.createTime == "null") {
            var inner = ""
        }
        else {
            var inner = row.createTime
        }

        var color = 'nowwrp'
        return [
            '<span class=' + color + '>' + inner + '</span>'
        ].join('');
    }//创建时间
    function mtimeFormatter(value, row, index) {
        if (row.modifyTime == null || row.modifyTime == "null") {
            var inner = ""
        }
        else {
            var inner = row.modifyTime
        }
        var color = 'nowwrp'

        return [
            '<span class=' + color + '>' + inner + '</span>'
        ].join('');
    }//修改时间
    function nikFormatter(value, row, index) {

        return [
            '<div class="nowwrp">',
//            '<a class="like2" href="#" title="操作">',
            row.nickname,
//            '</a>',
            '</div>'
        ].join("");
    }//昵称
    function picsFormatter(value, row, index) {
        var srcfront;
        var srcback;
        var srchand;
        var inner1;
        var inner2;
        var inner3;
        if (row.idCardImgs != null) {
            if (row.idCardImgs.front != null) {
                srcfront = row.idCardImgs.front;
                inner1 = "<img src='./img/shouchi.png' width='30' height='22' style='margin-left: 2px' title='正面'>"

            } else {
                srcfront = 1;
                inner1 = ""

            }
            if (row.idCardImgs.back != null) {
                srcback = row.idCardImgs.back;
                inner2 = "<img src='./img/fanmian.png' width='30' height='22' style='margin-left: 2px' title='反面'>"
            } else {
                srcback = 1;
                inner2 = ""

            }
            if (row.idCardImgs.hand != null) {
                srchand = row.idCardImgs.hand;
                inner3 = "<img src='./img/zhengmian.png' width='30' height='22' style='margin-left: 2px' title='手持'>"
            } else {
                srchand = 1;
                inner3 = ""

            }
        } else {
            srcfront = 1;
            srcback = 1;
            srchand = 1;
        }
        return [
            '<a class="zhankai1" id="tbpic1">',
            inner1,
            '</a>',
            '<a class="zhankai2" id="tbpic2">',
            inner2,
            '</a>',
            '<a class="zhankai3" id="tbpic3">',
            inner3,
            '</a>'
        ].join('');
    }//图片
    function realFormatter(value, row, index) {
        if (row.realname == null || row.realname == "null") {
            var inner = ""
        }
        else {
            var inner = row.realname
        }
        var color = 'nowwrp'
        return [
            '<span class=' + color + '>' + inner + '</span>'
        ].join('');
    }//真实姓名
    function genderFormatter(value, row, index) {
        if (row.gender == 0) {
            var inner = "男"
        }
        if (row.gender == 1) {
            var inner = "女"
        }
        if (row.gender == null || row.gender == "null") {
            var inner = ""
        }
        return [
            '<span>' + inner + '</span>'
        ].join('');
    }//性别
    function queryParams(params) {
        var param = {
            limit: this.pageSize, // 页面大小
            page: this.pageNumber,
        }
        return param;
    }

    function responseHandler(res) {
        dataResult = res;
        if (res) {
            return {
                "rows": res.list,
                "total": res.totalCount
            };
        } else {
            return {
                "rows": 10,
                "total": 20
            };
        }
        console.log(res);
    }

    var DELETE_ARR = []
    var operateEvents = {
        'click .edit1': function (e, value, row, index) {

            $("#eatTheWorld2  .userid").html(row.id)
            $("#eatTheWorld2  .name").val(row.nickname)

            $("#eatTheWorld2  .role").attr("disabled", "true")
            $("#eatTheWorld2  .logname").val(row.username)
            $("#eatTheWorld2  .password").val(row.password)
            $("#eatTheWorld2 .realname").val(row.realname)
            $("#eatTheWorld2  .idcard").val(row.identityNumber)
            $("#eatTheWorld2  .phone").val(row.phoneNumber)

            $("#eatTheWorld2").css("display", "block")
            $("#999").on("click", function () {
                $("#eatTheWorld2").hide()
            })
        },
        'click .delete': function (e, value, row, index) {
            DELETE_ARR.push(row.id)
        },
        'click .zhankai1': function (e, value, row, index) {
            var srcfront;
            var v = document.getElementById('divCenter');
            if (row.idCardImgs != null) {
                if (row.idCardImgs.front != null) {
                    srcfront = row.idCardImgs.front;
                    v.style.display = "block";
                    document.getElementById("carpic3").src = srcfront;

                } else {
                    srcfront = 1

                }

            } else {
                srcfront = 1;
            }
        },
        'click .zhankai2': function (e, value, row, index) {
            var srcback;
            var v = document.getElementById('divCenter');
            if (row.idCardImgs != null) {
                if (row.idCardImgs.back != null) {
                    srcback = row.idCardImgs.back;
                    v.style.display = "block";
                    document.getElementById("carpic3").src = srcback;

                } else {
                    srcback = 1
                }
            } else {
                srcback = 1;
            }
        },
        'click .zhankai3': function (e, value, row, index) {
            var srchand;
            var v = document.getElementById('divCenter');
            if (row.idCardImgs != null) {
                if (row.idCardImgs.hand != null) {
                    srchand = row.idCardImgs.hand;
                    v.style.display = "block";
                    document.getElementById("carpic3").src = srchand;
                } else {
                    srchand = 1

                }
            } else {
                srchand = 1;
            }
        }
    };

    function picClose() {
        var v = document.getElementById('divCenter');
        v.style.display = "none";
    }

    function deteleOdd(arr) {

        function QC(arr) {
            var s = [];
//遍历数组
            for (var i = 0; i < arr.length; i++) {
                if (s.indexOf(arr[i]) == -1) {  //判断在s数组中是否存在，不存在则push到s数组中
                    s.push(arr[i]);
                }
            }
            return s
        }

        var odd = []
        var s = QC(arr)

        for (var i = 0; i < s.length; i++) {
            var add = []
            for (var k = 0; k < arr.length; k++) {
                if (s[i] == arr[k]) {
                    add.push(arr[k])
                }

            }
            if (add.length % 2 !== 0) {
                odd.push(s[i])
            }
        }

        return odd
    }

    function getHeight() {
        var mainNavHeight = Number(sessionStorage.mainNavHeight)
        return $(window).height() - mainNavHeight - 16 - 16;
    }

    $("#deletuser").on('click', function () {

        if (deteleOdd(DELETE_ARR).length == 0) {

            alert("请先选中要删除的用户")
            return
        }
        if (confirm('您确定要删除已选用户吗?')) {
            $.ajax({
                url: "http://cjl3.rokyinfo.net:7200/api-user/v3.1/users/",
                contentType: "application/json; charset=utf-8",
                method: "delete",
                beforeSend: function (xhr) {
                    xhr.setRequestHeader("firm", sessionStorage.firmFlag);
                    xhr.setRequestHeader("Authorization", sessionStorage.token)
                },
                data: JSON.stringify(deteleOdd(DELETE_ARR)),
                success: function (res) {
                    console.log("成功")
                    alert("用户删除成功")
                    $table.bootstrapTable("refresh", {silent: true})
                },
                error: function (err) {
                    if (err.status == 403) alert("您没有权限执行此操作")
                    var json = JSON.parse(err.responseText);
                    alert(json.error.msg);
                }
            });
        }

        else {

        }
    });
    $(".searchWD").on("click", function () {      //wd
        var a = $(".selpr").val() ? "&province=" + $(".selpr").val() : "";
        var b = $(".selci").val() ? "&city=" + $(".selci").val() : "";
        var c = $(".selco").val() ? "&county=" + $(".selco").val() : "";
        console.log("http://cjl3.rokyinfo.net:7200/api-user/v3.1/ebikestores?types=0,1,2,3" + a + b + c);
        $.ajax({
            url: "http://cjl3.rokyinfo.net:7200/api-user/v3.1/ebikestores?types=0,1,2,3" + a + b + c + "&limit=900&page=1",
            method: "get",
            contentType: "application/json; charset=utf-8",
            cache: false,
            beforeSend: function (xhr) {
                xhr.setRequestHeader("firm", sessionStorage.firmFlag);
                xhr.setRequestHeader("Authorization", sessionStorage.token);
            },
            success: function (data) {
                console.log(data);
                $(".removeD").remove();
                var d = document.getElementById("app1");
                for (var i = 0; i < data.list.length; i++) {
                    var li = document.createElement("li");
                    var a = document.createElement("a");
                    a.className = "hoverE";
                    li.className = "removeD";
                    li.index = data.list[i].id;
                    li.appendChild(a)
                    d.appendChild(li)
                    li.onclick = function (ev) {
                        for (var i = 0; i < document.getElementsByClassName("hoverE").length; i++) {
                            document.getElementsByClassName("hoverE")[i].style.background = "white"
                        }
                        ev.target.style.background = "#d1c9c9";
                        id1 = this.index
                    };
                    a.innerHTML = data.list[i].name + "(" + data.list[i].address + ")"
                }

            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.log("失败");
                console.log(jqXHR);
            }
        });

    });
    $("#wrap-btn-off").on("click", function () {
        $("#wrap").hide()
    });

    $("#add1").unbind('click').on("click", function () {

        var name = $("#eatTheWorld  .ename").val()
        var logname = $("#eatTheWorld  .elogname").val();
        var pass = $("#eatTheWorld  .epassword").val();
        var real = $("#eatTheWorld  .erealname").val();
        var idcard = $("#eatTheWorld  .eidcard").val();
        var phonenum = $("#eatTheWorld  .ephone").val();

        var senddata = {
            "nickname": name,
            "username": logname,
            "password": pass,
            "realname": real,
            "identityNumber": idcard,
            "phoneNumber": phonenum

        };
        console.log(senddata);
        $.ajax({
            url: "http://cjl3.rokyinfo.net:7200/api-user/v3.1/users/",
            type: 'POST',
            data: JSON.stringify(senddata),
            contentType: "application/json; charset=utf-8",
            dataType: "text",
            beforeSend: function (xhr) {
                xhr.setRequestHeader("firm", sessionStorage.firmFlag);
                xhr.setRequestHeader("Authorization", sessionStorage.token)
            },

            success: function (res) {
                console.log("成功");
                alert("新增用户成功");
                $table.bootstrapTable("refresh", {silent: true});
                $("#eatTheWorld").hide()
            },
            error: function (err) {
                if (err.status == 403) alert("您没有权限执行此操作");
                alert("新增失败");
                console.log(err)

            }
        });
    });
    $("#revise").on("click", function () {
        var id = $("#eatTheWorld2  .userid").html();
        var a = $("#eatTheWorld2  .name").val();
        var c = $("#eatTheWorld2  .logname").val();
        var d = $("#eatTheWorld2  .password").val();
        var e = $("#eatTheWorld2 .realname").val();
        var f = $("#eatTheWorld2  .idcard").val();
        var g = $("#eatTheWorld2  .phone").val();
        var h = $("#eatTheWorld2  .mail").val();
        var data = {
            "nickname": a,
            "username": c,
            "password": d,
            "realname": e,
            "identityNumber": f,
            "phoneNumber": g,
            "email": h
        }
        console.log(data)
        var form = new FormData();
        form.append("nickname", a);
        form.append("username", c);
        form.append("password", d);
        form.append("realname", e);
        form.append("identityNumber", f);
        form.append("phoneNumber", g);
        form.append("email", h);

        $.ajax({
            url: "http://cjl3.rokyinfo.net:7200/api-user/v3.1/users/update/" + id,

            method: "post",
            data: form,
            processData: false,
            contentType: false,
            beforeSend: function (xhr) {
                xhr.setRequestHeader("firm", sessionStorage.firmFlag);
                xhr.setRequestHeader("Authorization", sessionStorage.token)
            },

            success: function (res) {
                console.log("成功")
                alert("修改成功")
                $table.bootstrapTable("refresh", {silent: true})
                $("#eatTheWorld2").hide()
            },
            error: function (err) {
                if (err.status == 403) alert("您没有权限执行此操作")

                console.log(err)

                var json = JSON.parse(err.responseText);
                alert(json.error.msg);
            }
        });
    })
    $(".searchCcu").on("click", function () {
        console.log("cjl3.rokyinfo.net:7200/api-user/v3.1/users?filter=" + $(".searchResult").val())
        $.ajax({
            url: "http://cjl3.rokyinfo.net:7200/api-user/v3.1/users?filter=" + $(".searchResult").val(),
            method: "get",
            contentType: "application/json; charset=utf-8",
            cache: false,
            beforeSend: function (xhr) {
                /* Authorization header */
                xhr.setRequestHeader("firm", sessionStorage.flag);
                xhr.setRequestHeader("Authorization", sessionStorage.token);
            },
            success: function (data) {
                $("#table").bootstrapTable('refresh', {
                    'url': "http://cjl3.rokyinfo.net:7200/api-user/v3.1/users?filter=" + $(".searchResult").val(),
                    pageNumber: 1,
                    pageSize: 20
                });
            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.log("失败")
                console.log(jqXHR);
            }
        });


    })

    $(function () {
        resizeLayout()

        initTable();
    });

    function resizeLayout() {

        var mainNavHeight = Number(sessionStorage.mainNavHeight)

        $(".ui-content").css('padding-top', (mainNavHeight + 16) + 'px');

    }

    $(window).resize(function () {
        resizeLayout()
        $table.bootstrapTable('resetView', {
            height: getHeight()
        });
    });
</script>

<script src="js/vendor/distpicker.data.js"></script>
<script src="js/vendor/distpicker.js"></script>
<script src="js/main.js"></script>
</html>
